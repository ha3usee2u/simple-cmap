
## simple-cmap

`simple-cmap` æ˜¯ä¸€å€‹ä½¿ç”¨ç´…é»‘æ¨¹å¯¦ä½œçš„ C èªè¨€éµå€¼å°å°è£æ¨¡çµ„ï¼Œæ”¯æ´é«˜æ•ˆæ’å…¥ã€æŸ¥è©¢ã€åˆªé™¤èˆ‡éæ­·æ“ä½œï¼Œå…·å‚™è‰¯å¥½è¨˜æ†¶é«”ç®¡ç†èˆ‡éŒ¯èª¤é˜²å‘†æ©Ÿåˆ¶ï¼Œé©åˆç³»çµ±å·¥å…·ã€åµŒå…¥å¼æ‡‰ç”¨æˆ–å€‹äººé–‹ç™¼ä½¿ç”¨ã€‚

## åŠŸèƒ½ç‰¹è‰²

* æä¾›é€šç”¨ APIï¼š`map_insert`, `map_get`, `map_remove`, `map_foreach`, `map_keys` ç­‰ã€‚
* æ¡ç”¨ç´…é»‘æ¨¹ï¼Œæ“ä½œæ•ˆç‡ç‚º O(log n)ï¼Œé©åˆå¤§é‡è³‡æ–™ã€‚
* æ”¯æ´è‡ªå®šæ¯”è¼ƒèˆ‡æ¸…é™¤å‡½å¼ï¼Œä½¿ç”¨è€…å¯è‡ªç”±æ±ºå®š key/value çš„ç®¡ç†æ–¹å¼ã€‚
* æ‰€æœ‰è³‡æºçš†æœ‰å®Œæ•´é‡‹æ”¾é‚è¼¯ï¼Œé˜²æ­¢è¨˜æ†¶é«”æ´©æ¼ã€‚
* å…·å‚™ NULL æª¢æŸ¥èˆ‡éŒ¯èª¤å›å‚³æ©Ÿåˆ¶ï¼Œå¯å®‰å…¨æ‡‰å°ä¸åˆæ³•è¼¸å…¥ã€‚

## å®‰è£èˆ‡ç·¨è­¯

1. å®‰è£ GCC æˆ– Clang ç·¨è­¯å™¨ã€‚
2. ä½¿ç”¨ç¯„ä¾‹ Makefile ç·¨è­¯ï¼š

   ```
   make
   ```
3. å¯é€é Dr. Memory æˆ– Valgrind åŸ·è¡Œè¨˜æ†¶é«”éŒ¯èª¤æª¢æŸ¥ã€‚

## ğŸ“¦ å°ˆæ¡ˆçµæ§‹

```
.
â”œâ”€â”€ c-map.h            # å…¬é–‹ API å®£å‘Š
â”œâ”€â”€ c-map.c            # ä¸»é«”é‚è¼¯å¯¦ä½œ
â”œâ”€â”€ map_internal.h     # ç´…é»‘æ¨¹å…§éƒ¨çµæ§‹èˆ‡å‡½å¼
â”œâ”€â”€ map_xxx.c          # æ’å…¥ã€åˆªé™¤ã€æœå°‹ç­‰æ¨¡çµ„åŒ–å¯¦ä½œæª”æ¡ˆ
â”œâ”€â”€ demo.c             # å–®å…ƒæ¸¬è©¦èˆ‡ä½¿ç”¨ç¯„ä¾‹
â””â”€â”€ README.md          # æœ¬èªªæ˜æ–‡ä»¶
```

## ğŸ“– ä½¿ç”¨ç¯„ä¾‹

```
#include "c-map.h"

intcompare(void* a, void* b){
    returnstrcmp((char*)a, (char*)b);
}

voidcleanup(void* key, void* val){
    free(key);
    free(val);
}

intmain(){
    map_t* map= map_create(compare, cleanup);
    map_insert(map, strdup("apple"), strdup("fruit"));
    printf("%s\n", (char*)map_get(map, "apple"));  // output: fruit
    map_free(map);
    return0;
}
```

## ğŸ§ª æ¸¬è©¦æ–¹å¼

ç·¨è­¯ä¸¦åŸ·è¡Œ `demo.c` å–®å…ƒæ¸¬è©¦ï¼š

```
gcc -std=c99 -g demo.c c-map.c map_*.c -o demo
./demo
```

è‹¥ä½¿ç”¨ Dr. Memoryï¼ˆWindowsï¼‰ï¼š

```
"C:\Program Files (x86)\Dr. Memory\bin\drmemory.exe"-- demo.exe
```

## ğŸ’¡ è¨­è¨ˆç†å¿µ

æ­¤æ¨¡çµ„è¨­è¨ˆä»¥  **å®‰å…¨æ€§** ã€**éˆæ´»æ€§** èˆ‡ **æ•ˆç‡** ç‚ºä¸»è»¸ï¼Œé€éç´…é»‘æ¨¹ç¢ºä¿æ“ä½œå¹³è¡¡ï¼Œä¸¦åŠ å…¥éŒ¯èª¤é˜²å‘†èˆ‡è‡ªå®šç¾©å‡½å¼ä»‹é¢ï¼Œæå‡å¯æ‡‰ç”¨æ€§ã€‚
